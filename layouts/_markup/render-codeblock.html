{{- $codeblock := .Attributes | merge (.Page.Param "codeblock") -}}
{{- $result := transform.HighlightCodeBlock . -}}
{{- $wrapper := $result.Wrapped -}}

{{- if $codeblock.wrapped -}}
  {{- if eq $codeblock.mode "simple" -}}
    {{- $wrapper = partial "code-wrapper/simple.html" (dict "Wrapper" $wrapper "Opts" $codeblock) -}}
  {{- else if eq $codeblock.mode "mac" -}}
    {{- $wrapper = partial "code-wrapper/mac.html" (dict "Wrapper" $wrapper "Opts" $codeblock) -}}
  {{- else -}}
    {{- $wrapper = partial "code-wrapper/normal.html" (dict "Wrapper" $wrapper "Opts" $codeblock "Type" .Type) -}}
  {{- end -}}
{{- end -}}

{{- $wrapper | safeHTML -}}
